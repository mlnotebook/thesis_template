\usepackage{titletoc}
\setcounter{tocdepth}{3}
\setcounter{secnumdepth}{3}
\newcommand{\tocrule}{\vspace{-1.5ex}\noindent\rule{\textwidth}{0.8pt}\medskip}

\setlistdepth{2000} % stops the 'enumerate' environment 'too deply nested' error